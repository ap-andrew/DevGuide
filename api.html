<h2>Working with APIs</h2>

<p>You have now created, deployed and invoked a basic API proxy. In this topic you will explore some RESTful APIs that are exposed by the API Platform to enable API management. These APIs are useful for exploring, debugging, and scripting the API proxy development lifecycle.</p>

All of the API Platform APIs are documented in [the ]node:4972].

<h3>List APIs in your organization</h3>

<pre>$ curl -u myname:mypass https://api.enterprise.apigee.com/v1/o/{org_name}/apis</pre>

<p>Sample Response:</p>
<pre>[ "weatherapi" ]</pre>

<h3>Get an API</h3>

<p>You can call the GET method on an API. This call returns a list of all available revisions of the API proxy.</p>
	
<pre>$ curl -u myname:mypass -H "Accept: application/json" https://api.enterprise.apigee.com/v1/o/{org_name}/apis/weatherapi</pre>
	
<p>Sample Response:</p>

<pre>{
  "name" : "weatherapi",
  "revision" : [ "1" ]
}</pre>

<p>The only detail we get is the name of the API along with a 'revision', which in turn has a number. </p>

<p>There is only one revision because you just created this API. As an API moves through the lifecycle of iterative configuration and deployment, the version number increments by integers.</p>

<h3>Get API Revision</h3>

<p>To obtain the detailed profile of an API configuration, you view a specific revision number.</p>

<p>For example, you can call the GET method on  API proxy revision 1 to get a detailed view.</p>

<pre>$ curl -u myname:mypass -H "Accept:application/json" https://api.enterprise.apigee.com/v1/o/{org_name}/apis/weatherapi/revisions/1</pre>
<p><b>Sample Response</b></p>
<pre>{
  "configurationVersion" : {
    "majorVersion" : 4,
    "minorVersion" : 0
  },
  "contextInfo" : "Revision 1 of application weatherapi, in organization {org_name}",
  "createdAt" : 1343178905169,
  "createdBy" : "andrew@apigee.com",
  "lastModifiedAt" : 1343178905169,
  "lastModifiedBy" : "andrew@apigee.com",
  "name" : "weatherapi",
  "policies" : [ ],
  "proxyEndpoints" : [ ],
  "resources" : [ ],
  "revision" : "1",
  "targetEndpoints" : [ ],
  "targetServers" : [ ],
  "type" : "Application"
}</pre>

<p>You can see here that all of the important pieces of the API are empty. There are no policies, no Endpoints, no resources. You will add these to your API in the next Developer Guide topics. You can also read about these configuration elements in the [node:8407].)</p>

<h3>Deploying an API to an environment</h3>

<p>Now that your API proxy is configured to receive and forward requests properly, you can deploy it to one or more environments. Usually, you iterate on API proxies in 'test' and then, when ready, you deploy an API proxy to 'prod'. You then publish the 'prod' URL to external developers.</p>
	
<p><b>Note:</b> An API proxy cannot be invoked until is has been deployed.</p>
<p>You deploy the API <b>revision</b> to an environment. First, check environments in your organization.</p>

<h3>How to List Environments</h3>

<p>Every organization on the API Platform has at least two environments: 'test' and 'prod'. The distinction is arbitrary. The goal is to provide you with an area to verify that your API proxy is working properly before you open it up to outside developers. Each environment is really just a network address, enabling you segregate traffic between the API proxies that you are working on, and those that are being accessed by apps at runtime.</p>

<h3>View environments in an organization</h3>

<pre>$ curl -u myname:mypass https://api.enterprise.apigee.com/v1/o/{org_name}/environments</pre>
<p>Sample Response</p>

<pre>[ "test", "prod" ]</pre>

<h3>Deploy your API to the Test Environment</h3>

<p>Now, deploy the API to the test environment</p>

<pre>$ curl -u myname:mypass https://api.enterprise.apigee.com/v1/o/{org_name}/apis/weatherapi/revisions/1/deployments?action=deploy&env=test&basepath=/</pre>

<p>Sample Response</p>

<pre>{
  "aPIProxy" : "weatherapi",
  "environment" : [ test ],
  "name" : "1",
  "organization" : "{org_name}"
}</pre>


<h3>Explore Deployments</h3>

<p>A "deployment" is a deployed revision of your API. It is often useful to check to see in which environment (and if!) your API is deployed. </p>

<p>For example, you might find requests to your API proxy are failing. One troubleshooting step is to ensure that the API is deployed as expected.</p>

<h3>See All Deployments of an API Revision</h3>
<div id="well"><pre>curl -u myname:mypass https://api.enterprise.apigee.com/v1/o/{org_name}/apis/weatherapi/revision/1/deployments</pre></div>

<pre>{
  "aPIProxy" : "weatherapi",
  "environment" : [ {
    "configuration" : {
      "basePath" : "",
      "steps" : [ ]
    },
    "name" : "test",
    "server" : [ {
      "status" : "deployed",
      "type" : [ "message-processor" ],
      "uUID" : "90096dd1-1019-406b-9f42-fbb80cd01200"
    }, {
      "status" : "deployed",
      "type" : [ "message-processor" ],
      "uUID" : "7d6e2eb1-581a-4db0-8045-20d9c3306549"
    }, {
      "status" : "deployed",
      "type" : [ "router" ],
      "uUID" : "1619e2d7-c822-45e0-9f97-63882fb6a805"
    }, {
      "status" : "deployed",
      "type" : [ "router" ],
      "uUID" : "8a5f3d5f-46f8-4e99-b4cc-955875c8a8c8"
    } ],
    "state" : "deployed"
  } ],
  "name" : "1",
  "organization" : "org_name"
}</pre>

<h3>See All Deployments in the Test Environment</h3>
<pre>$ curl -u myname:mypass https://api.enterprise.apigee.com/v1/o/{org_name}/environments/test/deployments</pre>

<p>Returns the same result as above for every API deployed in the test environment
</p>

<h3>See All Deployments in your organization</h3>
<pre>$ curl -u myname:mypass https://api.enterprise.apigee.com/v1/o/{org_name}/deployments</pre>
<p>Returns the same result as above for all API proxies deployed in all environments.
</p>

<p>Since the API is RESTful, you can simply use the POST method, along with a JSON or XML payload, against the same resource to create an API proxy.</p>

<p>A profile for your API proxy is generated on the API Platform. The default representation of an API proxy is JavaScript object notation (JSON). Below is the default JSON response to the POST request above, which created an API proxy called 'weatherapi'. A description of each element in the profile follows:</p>

	<pre>{
  "configurationVersion" : {
    "majorVersion" : 4,
    "minorVersion" : 0
  },
  "contextInfo" : "Revision 1 of application weatherapi, in organization {org_name}",
  "createdAt" : 1357172145444,
  "createdBy" : "you@yourcompany.com",
  "displayName" : "weatherapi",
  "lastModifiedAt" : 1357172145444,
  "lastModifiedBy" : "you@yourcompany.com",
  "name" : "weatherapi",
  "policies" : [ ],
  "proxyEndpoints" : [ ],
  "resources" : [ ],
  "revision" : "1",
  "targetEndpoints" : [ ],
  "targetServers" : [ ],
  "type" : "Application"
}</pre>
	
<p><span class="label label-info">Note</span> Keep in mind that the response payload merely contains a representation of an API resource--you can create an API proxy using JSON or XML, and you can also retrieve representations of the API proxy as XML or JSON, depending on your needs.</p>

<p>The API proxy profile that is generated demonstrates the complete structure of an API proxy:</p>
<ul>
	<li><code>APIProxy revision</code>: The sequentially numbered iteration of the API proxy configuration, as maintained by the API Platform</li>
	<li><code>APIProxy name</code>: The unique name of the API proxy</li>
	<li><code>ConfigurationVersion</code>: API Platform version to which the API proxy configuration conforms</li>
	<li><code>CreatedAt</code>: Time when the API proxy was generated on the API platform, formatted in UNIX time</li>
	<li><code>CreatedBy</code>: Email address of the Apigee user who created the API proxy</li>
	<li><code>DisplayName</code>: A user-friendly name for the API proxy</li>
	<li><code>LastModifiedAt</code>: Time when the API proxy was generated on the API platform, formatted in UNIX time</li>
	<li><code>LastModifiedBy</code>: Email address of the Apigee user who created the API proxy on the API platform</li>
	<li><code>Policies</code>: A list of policies that have been added to this API proxy</li>
	<li><code>ProxyEndpoints</code>: A list of named ProxyEndpoints</li>
	<li><code>Resources</code>: A list of resources (JavaScript, Python, Java, XSLT) available to be executed in this API proxy</li>
	<li><code>TargetServers</code>: A list of named TargetServers (that can be created using the APi Platform API), used in advanced configurations for load balancing purposes</li>
	<li><code>TargetEndpoints</code>: A list of named TargetEndpoints</li>
</ul>

<p>Note that many of the elements of the API proxy configuration created using the simple POST method above are empty. In the following Developer Guide topics, you will learn how to add and configure the key components of an API proxy.</p>


<p>Post questions to the <a href="http://support.apigee.com">Apigee Developer Forum</a>.</p>

<p>Back to <a href="/docs/enterprise/content/developer_guide">API Platform Developer Guide</a>.</p>
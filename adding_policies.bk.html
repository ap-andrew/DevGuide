<h2>Configuring conditional policy enforcement</h2>

<p>A powerful feature of the API Platform is conditional policy enforcement.</p>

<p>Conditional statements can be added to policy attachments. For example, to add a conditional statement that enforces a quota policy only for XML messages:</p>

<pre>&lt;Step&gt;
  &lt;Condition&gt;request.header.content-type = "text/xml"&lt;/Condition&gt;
    &lt;Name&gt;QuotaPolicy&lt;/Name&gt;
&lt;/Step&gt;</pre>

<p>The configuration above enforces the Quota policy as a processing Step only if the conditional statement evaluates to true. In other words, the Quota is enforced on inbound request messages where the HTTP <code>content-type</code> header is set to <code>text/xml</code>.</p>

<p>The API Platform evaluates the HTTP <code>content-type</code> header in the request message from the client, and checks to see whether that value equals <code>text/xml</code>. If the condition evaluates to true, the policy is enforced. If not, the policy is bypassed.</p>

<p>The API Platform automatically makes all HTTP headers and query parameters available as variables. For example, the following request message to an API:</p>

<p>$ curl http://apifactory-test.apigee.net/weather/forecastrss?w=12797282&apikey=h789srfhuih -H "User-Agent:Mozilla/5.0"</p>

<p>Results in the following variables being set:</p>

<pre>request.queryParam.w=12797282
request.queryParam.apikey=h789srfhuih
request.header.User-Agent=User-Agent:Mozilla/5.0</pre>

<p>Conditions have two components, a <i>variable</i> and a <i>conditional operator</i>.</p>

<p>The configuration above uses a variable defined by Apigee: <code>request.header.content-type</code>. Many other variables are defined by the API Platform, providing a rich environment in which to implement dynamic, context-driven behavior. You can also define your own custom variables to support dynamic behavior specific to the content of the messages that your apps and API exchange.</p>

<p>For more, refer to the the list of [node:243] and [node:231].</p>